{% extends 'base.html' %}

{% block Title %} Pacienti {% endblock %}

{% block Content %}
	{% include 'patients_table.html' with {'patients': patients}%}
	<br />
	<div id="page_controls">
		<div id="pages" style="float: left; margin-right: 100px;">
			<a class="hand" onclick="$.prevPage();" style="color: gray; font-size: 22px; text-decoration:none" >&#8592; </a>
			<a class="hand" onclick="$.nextPage();" style="color: gray; font-size: 22px; text-decoration:none" > &#8594;</a>
		</div>
		<div id="currentlyShowing" style="float: left; display: block;"></div>
		<div id="ssp" style="float: right;">
			Arata 
			<select id="pager" onchange="changeItems(parseInt($(this).val()));" style="">
			
			</select>
			(de) intrari
		</div>
	</div>
	<div id="add_new_patient" style="clear: both;">
		<h4>Adauga un pacient nou</h4>
		<hr />
		<form action="resources/scripts/phpscripts/new_patient.php" method="post" id="addPatientForm">
			<table>
				<tr>
					<td>Nume:</td>
					<td><input type="text" name="lastname" /></td>
				</tr>
				<tr>
					<td>Prenume:</td>
					<td><input type="text" name="firstname" /></td>
				</tr>
				<tr>
					<td>CNP:</td>
					<td><input type="text" name="cnp" /></td>
				</tr>
			</table>
			<input type="submit" value="Adauga" class="btn" />
		</form>
	</div>
{% endblock %}

{% block Bottom %}
	{{ parent() }}
	<script type="text/javascript" src="resources/scripts/jscripts/utils.js"></script>
	<script type="text/javascript" src="resources/scripts/jscripts/jquery.spager.js"></script>
	<script type="text/javascript">
		$("#patients").spager({
                    
                    items:    {{ sort.po }},
                    ctrls:    "page_controls",
                    animate:  true,
                    opts:     [5,10,20,50],
                    offset:   {{ sort.offset }},
                    isLast:   {{ sort.isLast }},
                    ipp:      {{ sort.ipp }},
                    startPage:{{ pg }}
                    });
		function changePage(t) {window.location.href = 'patient.php?by=' + t;}
		function changeItems(t) {window.location.href = 'patient.php?po=' + t;}
	</script>
	<script type="text/javascript">
		$(function () {
			$.validator.addMethod("cnp", function(value, element) { return checkCNP(value); });
			$('#addPatientForm').validate({
				rules: {
					lastname: "required",
					firstname: "required",
					cnp: { required: true, digits: true, minlength: 13, maxlength: 13, cnp: true }
				},
				messages: {
					lastname: "Introdu numele pacientului",
					firstname: "Introdu prenumele pacientului",
					cnp: {
						required: "Introdu codul CNP al pacientului",
						digits: "Codul CNP contine doar cifre",
						minlength: jQuery.format("Codul CNP trebuie sa contina {0} cifre"),
						maxlength: jQuery.format("Codul CNP trebuie sa contina {0} cifre"),
						cnp: "Codul CNP nu este valid"
					}
				}
			});
		});
	</script>
{% endblock %}
